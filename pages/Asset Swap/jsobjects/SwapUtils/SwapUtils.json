{
  "gitSyncId": "67a2400b3e12e107acd1a186_asset-swap-jsutils",
  "id": "Asset Swap_SwapUtils",
  "unpublishedCollection": {
    "name": "SwapUtils",
    "pageId": "Asset Swap",
    "pluginId": "js-plugin",
    "pluginType": "JS",
    "body": "export default {\n\t// Refresh balances when owner/platform selection changes\n\trefreshOwner1Balance: async () => {\n\t\tif (Owner1Select.selectedOptionValue && Platform1Select.selectedOptionValue) {\n\t\t\tawait Owner1BalanceQuery.run();\n\t\t}\n\t},\n\t\n\trefreshOwner2Balance: async () => {\n\t\tif (Owner2Select.selectedOptionValue && Platform2Select.selectedOptionValue) {\n\t\t\tawait Owner2BalanceQuery.run();\n\t\t}\n\t},\n\t\n\t// Validate swap before execution\n\tvalidateSwap: () => {\n\t\tconst errors = [];\n\t\t\n\t\tif (!Owner1Select.selectedOptionValue) errors.push('Select Owner 1');\n\t\tif (!Owner2Select.selectedOptionValue) errors.push('Select Owner 2');\n\t\tif (!Platform1Select.selectedOptionValue) errors.push('Select Platform for Leg 1');\n\t\tif (!Platform2Select.selectedOptionValue) errors.push('Select Platform for Leg 2');\n\t\tif (!Currency1Select.selectedOptionValue) errors.push('Select Currency for Leg 1');\n\t\tif (!Currency2Select.selectedOptionValue) errors.push('Select Currency for Leg 2');\n\t\tif (!Amount1Input.text || parseFloat(Amount1Input.text) <= 0) errors.push('Enter valid Amount for Leg 1');\n\t\tif (!Amount2Input.text || parseFloat(Amount2Input.text) <= 0) errors.push('Enter valid Amount for Leg 2');\n\t\t\n\t\tif (Owner1Select.selectedOptionValue === Owner2Select.selectedOptionValue) {\n\t\t\terrors.push('Owner 1 and Owner 2 must be different');\n\t\t}\n\t\t\n\t\treturn errors;\n\t},\n\t\n\t// Execute the swap with validation\n\texecuteSwapWithValidation: async () => {\n\t\tconst errors = this.validateSwap();\n\t\t\n\t\tif (errors.length > 0) {\n\t\t\tshowAlert(errors.join('\\n'), 'error');\n\t\t\treturn;\n\t\t}\n\t\t\n\t\ttry {\n\t\t\tawait ExecuteSwap.run();\n\t\t\tshowAlert('Swap executed successfully!', 'success');\n\t\t\t\n\t\t\t// Refresh data\n\t\t\tawait RecentSwapsQuery.run();\n\t\t\tawait this.refreshOwner1Balance();\n\t\t\tawait this.refreshOwner2Balance();\n\t\t\t\n\t\t\t// Clear amounts\n\t\t\tresetWidget('Amount1Input');\n\t\t\tresetWidget('Amount2Input');\n\t\t} catch (e) {\n\t\t\tshowAlert('Swap failed: ' + e.message, 'error');\n\t\t}\n\t},\n\t\n\t// Generate swap summary text\n\tgetSwapSummary: () => {\n\t\tif (!Owner1Select.selectedOptionValue || !Owner2Select.selectedOptionValue) {\n\t\t\treturn 'Select both owners to see swap summary';\n\t\t}\n\t\t\n\t\tconst amt1 = Amount1Input.text || '0';\n\t\tconst amt2 = Amount2Input.text || '0';\n\t\tconst cur1 = Currency1Select.selectedOptionLabel || '???';\n\t\tconst cur2 = Currency2Select.selectedOptionLabel || '???';\n\t\tconst own1 = Owner1Select.selectedOptionLabel || '???';\n\t\tconst own2 = Owner2Select.selectedOptionLabel || '???';\n\t\tconst plat1 = Platform1Select.selectedOptionLabel || '???';\n\t\tconst plat2 = Platform2Select.selectedOptionLabel || '???';\n\t\t\n\t\treturn `${own1} gives ${amt1} ${cur1} (on ${plat1}) to ${own2}\\n` +\n\t\t       `${own2} gives ${amt2} ${cur2} (on ${plat2}) to ${own1}`;\n\t}\n}",
    "variables": []
  }
}
