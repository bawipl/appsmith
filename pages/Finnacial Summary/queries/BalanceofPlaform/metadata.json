{
  "gitSyncId": "67a2400b3e12e107acd1a186_03f966e5-f7db-4ced-b05c-03db7856eb78",
  "id": "Finnacial Summary_BalanceofPlaform",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "WITH base AS (\n    SELECT\n        co.owner_id AS owner,\n        p.name      AS platform,\n        c.shortcode AS currency,\n        SUM(\n            CASE\n                WHEN co.direction = 'in'  THEN co.amount\n                WHEN co.direction = 'out' THEN -co.amount\n                ELSE 0\n            END\n        ) AS balance\n    FROM cashoperations co\n    JOIN platforms p  ON p.id = co.platform_id\n    JOIN currencies c ON c.\"ID\" = co.currency_id\n    WHERE\n     \n         p.name = {{appsmith.store.platform}}\n    GROUP BY co.owner_id, p.name, c.shortcode\n)\n\n-- Detailed rows + per-currency totals\nSELECT\n    owner,\n    platform,\n    currency,\n    balance\nFROM (\n    -- Individual platform rows\n    SELECT\n        owner,\n        platform,\n        currency,\n        balance,\n        0 AS sort_order\n    FROM base\n\n    UNION ALL\n\n    -- Total per currency\n    SELECT\n        '[TOTAL]' AS owner,\n        NULL      AS platform,\n        currency,\n        SUM(balance) AS balance,\n        1 AS sort_order\n    FROM base\n    GROUP BY currency\n) t\nORDER BY currency, sort_order, owner;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "WieczorekAssets",
      "isAutoGenerated": false,
      "name": "WieczorekAssets",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": true,
    "name": "BalanceofPlaform",
    "pageId": "Finnacial Summary",
    "userSetOnLoad": false
  }
}